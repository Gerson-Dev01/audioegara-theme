{% comment %}
  collection.liquid
  Colección con filtros nativos de Shopify por tipo de producto + paginación
{% endcomment %}

<div class="collection-container">
  <h1>{{ collection.title }}</h1>

  {%- if collection.filters.size > 0 -%}
    <div class="filters">
      <form method="get">
        {% for filter in collection.filters %}
          {% if filter.type == 'list' and filter.param_name == 'filter.p.product_type' %}
            <label for="product-type">{{ filter.label }}</label>
            <select
              id="product-type"
              name="{{ filter.param_name }}"
              onchange="this.form.submit()"
            >
              <option value="">
                Todos
              </option>

              {% for value in filter.values %}
                <option
                  value="{{ value.value }}"
                  {% if value.active %}selected{% endif %}
                >
                  {{ value.label }} ({{ value.count }})
                </option>
              {% endfor %}
            </select>
          {% endif %}
        {% endfor %}
      </form>
    </div>
  {%- endif -%}

  {% paginate collection.products by 12 %}
    {% if collection.products.size > 0 %}
      <div class="product-grid">
        {% for product in collection.products %}
          <div class="product-item">
            <a href="{{ product.url }}">
              <h3>{{ product.title }}</h3>

              {% if product.featured_image %}
                <img
                  src="{{ product.featured_image | image_url: width: 300 }}"
                  alt="{{ product.title }}"
                  loading="lazy"
                >
              {% else %}
                <p>No hay imagen disponible</p>
              {% endif %}

              <p>{{ product.price | money }}</p>
            </a>
          </div>
        {% endfor %}
      </div>

      {% if paginate.pages > 1 %}
        <nav class="pagination">
          {% if paginate.previous %}
            <a href="{{ paginate.previous.url }}">← Anterior</a>
          {% endif %}

          <span>Página {{ paginate.current_page }} de {{ paginate.pages }}</span>

          {% if paginate.next %}
            <a href="{{ paginate.next.url }}">Siguiente →</a>
          {% endif %}
        </nav>
      {% endif %}
    {% else %}
      <p>No hay productos que coincidan con el filtro.</p>
    {% endif %}
  {% endpaginate %}
</div>

<style>
  .collection-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
  }

  .filters {
    margin-bottom: 20px;
  }

  .filters label {
    margin-right: 10px;
    font-weight: bold;
  }

  .filters select {
    padding: 8px;
  }

  .product-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 20px;
  }

  .product-item {
    border: 1px solid #ddd;
    padding: 10px;
    text-align: center;
  }

  .product-item img {
    max-width: 100%;
    height: auto;
  }

  .pagination {
    margin-top: 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
</style>
